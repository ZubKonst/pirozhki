dbvolume:
  image: ubuntu:14.04
  command: true
  volumes:
   - /var/lib/postgresql/data
   - /data

postgres:
  image: postgres:9.3
  environment:
    POSTGRES_USER: pirozhki
    POSTGRES_PASSWORD: mysecretpassword
  volumes_from:
    - dbvolume

redis:
  image: redis:2.8
  command: redis-server --appendonly yes
  volumes_from:
    - dbvolume

web:
  build: .
  command: puma -C config/sidekiq_web.rb
  environment:
    APP_ENV: development
  ports:
    - 3000:3000
  links:
    - redis:redis

workers:
  build: .
  command: sidekiq -r ./app.rb -C config/variables/sidekiq.yml
  environment:
    APP_ENV: development
  links:
    - postgres:postgres
    - redis:redis
